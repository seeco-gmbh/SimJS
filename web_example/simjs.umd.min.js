!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SimJS={})}(this,function(e){"use strict";class t{constructor(){this.events=[]}get(e){if(!this.has(e))throw new Error(`Key ${e} not found`);return e._value}has(e){return this.events.includes(e)}[Symbol.iterator](){return this.events[Symbol.iterator]()}keys(){return this.events.values()}values(){return this.events.map(e=>e._value)}entries(){return this.events.map(e=>[e,e._value])}toDict(){return this.events.reduce((e,t)=>(e[t.toString()]=t._value,e),{})}toString(){return`<ConditionValue ${JSON.stringify(this.toDict())}>`}}class s{constructor(e,t=null,s=[]){this.env=e,this.callbacks=[],this._ok=void 0,this._defused=!1,this._value="PENDING",this._evaluate=t,this._events=Array.from(s),this._count=0,this._events.length>0&&this._initializeCondition()}_initializeCondition(){for(let e of this._events){if(e.env!==this.env)throw new Error("Mixing events from different environments is not allowed");null===e.callbacks?this._check(e):e.callbacks.push(this._check.bind(this))}this.callbacks.push(this._buildValue.bind(this))}get triggered(){return"PENDING"!==this._value}get processed(){return null===this.callbacks}get ok(){if(!this.triggered)throw new Error(`Value of ${this} is not yet available`);return this._ok}get defused(){return this._defused}set defused(e){this._defused=e}get value(){if("PENDING"===this._value)throw new Error(`Value of ${this} is not yet available`);return this._value}trigger(e){this._ok=e._ok,this._value=e._value,this._scheduled||(this.env.schedule(this),this._scheduled=!0)}succeed(e=null){if("PENDING"!==this._value)throw new Error(`${this} has already been triggered`);return this._ok=!0,this._value=e,this._scheduled||(this.env.schedule(this),this._scheduled=!0),this}fail(e){if("PENDING"!==this._value)throw new Error(`${this} has already been triggered`);if(!(e instanceof Error))throw new TypeError(`${e} is not an exception.`);return this._ok=!1,this._value=e,this._scheduled||(this.env.schedule(this),this._scheduled=!0),this}and(e){return new s(this.env,s.allEvents,[this,e])}or(e){return new s(this.env,s.anyEvents,[this,e])}_check(e){"PENDING"===this._value&&(this._count+=1,e._ok?this._evaluate(this._events,this._count)&&this.succeed(new t):(e._defused=!0,this.fail(e._value)))}_buildValue(e){this._removeCheckCallbacks(),e._ok&&(this._value=new t,this._populateValue(this._value))}_populateValue(e){for(let t of this._events)null===t.callbacks&&e.events.push(t)}_removeCheckCallbacks(){for(let e of this._events)e.callbacks&&e.callbacks.includes(this._check.bind(this))&&(e.callbacks=e.callbacks.filter(e=>e!==this._check.bind(this)))}_desc(){return this._evaluate?`${this.constructor.name}(${this._evaluate.name}, ${this._events})`:`${this.constructor.name}()`}toString(){return`<${this._desc()} object>`}static allEvents(e,t){return e.length===t}static anyEvents(e,t){return t>0||0===e.length}}class i extends s{constructor(e,t){super(e),this.callbacks=[t._resume.bind(t)],this._ok=!0,e.schedule(this,"URGENT")}}class r extends Error{constructor(e=null){super(`Interrupt(${e})`),this.cause=e,this.name="Interrupt"}toString(){return`${this.name}: ${this.cause}`}}class o extends Error{constructor(e){super("StopSimulation"),this.event=e,this.name="StopSimulation"}static callback(e){throw e.ok?new o(e.value):e._value}toString(){return`${this.name}(${this.event})`}}class n extends Error{constructor(){super("EmptySchedule"),this.name="EmptySchedule"}}class a extends s{constructor(e,t){super(e);const s=t();if("function"!=typeof s.throw)throw new Error(`${t} is not a generator.`);this._generator=s,this._target=new i(e,this)}get name(){return this._generator.constructor.name||"anonymous"}get isAlive(){return"PENDING"===this._value}interrupt(e=null){this.isAlive&&(this._ok=!1,this._value=new r(e).toString(),this.env.schedule(this))}_resume(e){this.env.activeProcess=this;let t=e;try{for(;null!==t;){if(t._ok){const e=this._generator.next(t._value);if(e.done){this._ok=!0,this._value=e.value;break}t=e.value}else{const e=this._generator.throw(t._value);if(e.done){this._ok=!0,this._value=e.value;break}t=e.value}if(!(t instanceof s))throw new Error(`Invalid Yield value "${t}"`);if(null!==t.callbacks){t.callbacks.push(this._resume.bind(this));break}}null===t&&(this._ok=!0,this._value=this._generator.return?this._generator.return(void 0).value:null)}catch(e){this._ok=!1,this._value=e,this.env.schedule(this)}finally{this.env.activeProcess=null}}}class c{constructor(e){this.compare=e,this.items=[]}size(){return this.items.length}peek(){return this.items[0]}push(e){this.items.push(e),this._heapifyUp()}pop(){if(0===this.size())return null;const e=this.peek(),t=this.items.pop();return this.size()>0&&(this.items[0]=t,this._heapifyDown()),e}_heapifyUp(){let e=this.size()-1;const t=this.items[e];for(;e>0;){const s=Math.floor((e-1)/2),i=this.items[s];if(this.compare(t,i)>=0)break;this.items[s]=t,this.items[e]=i,e=s}}_heapifyDown(){let e=0;const t=this.size(),s=this.items[0];for(;;){let i=2*e+1,r=2*e+2,o=e;if(i<t&&this.compare(this.items[i],this.items[o])<0&&(o=i),r<t&&this.compare(this.items[r],this.items[o])<0&&(o=r),o===e)break;this.items[e]=this.items[o],this.items[o]=s,e=o}}}class h extends s{constructor(e,t){if(super(e.env),t<=0)throw new Error(`Amount (${t}) must be > 0.`);this.resource=e,this.amount=t,this.proc=this.env.activeProcess,this.resource.putQueue.push(this),this.callbacks.push(this.resource._triggerGet.bind(this.resource)),this.resource._triggerPut()}cancel(){if(!this.triggered){const e=this.resource.putQueue.indexOf(this);e>-1&&this.resource.putQueue.splice(e,1)}}}class u extends s{constructor(e,t){if(super(e.env),t<=0)throw new Error(`Amount (${t}) must be > 0.`);this.resource=e,this.amount=t,this.proc=this.env.activeProcess,this.resource.getQueue.push(this),this.callbacks.push(this.resource._triggerPut.bind(this.resource)),this.resource._triggerGet()}cancel(){if(!this.triggered){const e=this.resource.getQueue.indexOf(this);e>-1&&this.resource.getQueue.splice(e,1)}}}class l{constructor(e,t){this.env=e,this.capacity=t,this.putQueue=[],this.getQueue=[]}put(e){return new h(this,e)}get(e){return new u(this,e)}_triggerPut(e=null){let t=0;for(;t<this.putQueue.length;){const e=this.putQueue[t],s=this._doPut(e);if(e.triggered?this.putQueue.splice(t,1):t+=1,!s)break}}_triggerGet(e=null){let t=0;for(;t<this.getQueue.length;){const e=this.getQueue[t],s=this._doGet(e);if(e.triggered?this.getQueue.splice(t,1):t+=1,!s)break}}}class m{constructor(e){this.logEntries=[],this.hooks=[],this.LOG_LEVELS={DEBUG:0,INFO:1,WARN:2,ERROR:3,CRITICAL:4},this.config=e,this.formatter=this.getFormatter(e.outputFormat)}getFormatter(e){switch(e){case"JSON":return this.jsonFormatter.bind(this);case"CSV":return this.csvFormatter.bind(this);default:return this.textFormatter.bind(this)}}shouldLog(e){return this.LOG_LEVELS[e]>=this.LOG_LEVELS[this.config.logLevel]}log(e){this.shouldLog(e.level)&&(e.timestamp=Date.now(),this.logEntries.push(e),this.logEntries.length>this.config.maxLogEntries&&this.logEntries.shift(),this.hooks.forEach(t=>{try{t(e)}catch(e){}}))}addHook(e){this.hooks.push(e)}removeHook(e){const t=this.hooks.indexOf(e);t>-1&&this.hooks.splice(t,1)}getLogEntries(e){return e?this.logEntries.filter(t=>Object.entries(e).every(([e,s])=>t[e]===s)):[...this.logEntries]}exportLogs(){return"CSV"===this.config.outputFormat?this.exportToCSV():"JSON"===this.config.outputFormat?this.exportToJSON():this.exportToText()}exportToCSV(){if(0===this.logEntries.length)return"";const e=this.logEntries.map(e=>[new Date(e.timestamp).toISOString(),e.simulationTime.toString(),e.level,e.type,e.component,`"${e.message.replace(/"/g,'""')}"`,e.metadata?`"${JSON.stringify(e.metadata).replace(/"/g,'""')}"`:""]);return[["timestamp","simulationTime","level","type","component","message","metadata"].join(","),...e.map(e=>e.join(","))].join("\n")}exportToJSON(){return JSON.stringify({exportTime:(new Date).toISOString(),totalEntries:this.logEntries.length,config:this.config,entries:this.logEntries},null,2)}exportToText(){return this.logEntries.map(e=>this.textFormatter(e)).join("\n")}textFormatter(e){let t=`[${new Date(e.timestamp).toISOString()}] [${e.simulationTime.toFixed(3)}] ${e.level.padEnd(8)} ${e.component.padEnd(12)} ${e.message}`;return e.metadata&&Object.keys(e.metadata).length>0&&(t+=` | ${JSON.stringify(e.metadata)}`),t}jsonFormatter(e){return JSON.stringify(e)}csvFormatter(e){return[new Date(e.timestamp).toISOString(),e.simulationTime.toString(),e.level,e.type,e.component,`"${e.message.replace(/"/g,'""')}"`,e.metadata?`"${JSON.stringify(e.metadata).replace(/"/g,'""')}"`:""].join(",")}clear(){this.logEntries=[]}getStatistics(){const e={totalEntries:this.logEntries.length,entriesByLevel:{},entriesByType:{},entriesByComponent:{},timeRange:{start:this.logEntries.length>0?this.logEntries[0].simulationTime:0,end:this.logEntries.length>0?this.logEntries[this.logEntries.length-1].simulationTime:0}};return this.logEntries.forEach(t=>{e.entriesByLevel[t.level]=(e.entriesByLevel[t.level]||0)+1,e.entriesByType[t.type]=(e.entriesByType[t.type]||0)+1,e.entriesByComponent[t.component]=(e.entriesByComponent[t.component]||0)+1}),e}}class g{constructor(e,t=1e3){this.isMonitoring=!1,this.eventsProcessed=0,this.eventExecutionTimes=[],this.simulationStartTime=0,this.eventQueueSize=0,this.performanceHistory=[],this.maxHistorySize=1e3,this.logger=e,this.sampleInterval=t,this.simulationStartTime=Date.now()}start(){this.isMonitoring||(this.isMonitoring=!0,this.simulationStartTime=Date.now())}stop(){this.isMonitoring&&(this.isMonitoring=!1)}recordEventExecution(e){this.eventsProcessed++,this.eventExecutionTimes.push(e),this.eventExecutionTimes.length>1e4&&(this.eventExecutionTimes=this.eventExecutionTimes.slice(-5e3))}updateEventQueueSize(e){this.eventQueueSize=e}sampleMetrics(){const e=Date.now(),t=this.collectMetrics(e);this.performanceHistory.push(t),this.performanceHistory.length>this.maxHistorySize&&this.performanceHistory.shift();const s={timestamp:e,simulationTime:(e-this.simulationStartTime)/1e3,level:"DEBUG",type:"PERFORMANCE_SAMPLE",message:`Performance: ${t.eventsProcessed} events, ${t.simulationSpeed.toFixed(2)} events/sec, ${t.heapUsed.toFixed(1)}MB memory`,component:"PerformanceMonitor",metrics:t};this.logger.log(s)}collectMetrics(e){const t=this.getMemoryUsage(),s=(e-this.simulationStartTime)/1e3;return{heapUsed:t.heapUsed,heapTotal:t.heapTotal,eventQueueSize:this.eventQueueSize,eventsProcessed:this.eventsProcessed,averageEventExecutionTime:this.calculateAverageExecutionTime(),simulationSpeed:s>0?this.eventsProcessed/s:0,cpuUsage:this.getCPUUsage()}}getMemoryUsage(){try{const e=globalThis.process;if(e&&e.memoryUsage){const t=e.memoryUsage();return{heapUsed:t.heapUsed/1024/1024,heapTotal:t.heapTotal/1024/1024}}const t=globalThis.performance;if(t&&t.memory){const e=t.memory;return{heapUsed:e.usedJSHeapSize/1024/1024,heapTotal:e.totalJSHeapSize/1024/1024}}}catch(e){}return{heapUsed:0,heapTotal:0}}getCPUUsage(){try{const e=globalThis.process;if(e&&e.cpuUsage){const t=e.cpuUsage();return(t.user+t.system)/1e6}}catch(e){}}calculateAverageExecutionTime(){if(0===this.eventExecutionTimes.length)return 0;return this.eventExecutionTimes.reduce((e,t)=>e+t,0)/this.eventExecutionTimes.length}getCurrentMetrics(){return this.collectMetrics(Date.now())}getPerformanceHistory(){return[...this.performanceHistory]}getPerformanceSummary(){const e=(Date.now()-this.simulationStartTime)/1e3,t=e>0?this.eventsProcessed/e:0,s=this.performanceHistory.map(e=>e.heapUsed),i=s.length>0?Math.max(...s):0,r=s.length>0?s.reduce((e,t)=>e+t,0)/s.length:0,o=this.eventExecutionTimes.length>0?Math.max(...this.eventExecutionTimes):0,n=this.eventExecutionTimes.length>0?Math.min(...this.eventExecutionTimes):0;let a=0;if(this.eventExecutionTimes.length>0){const e=[...this.eventExecutionTimes].sort((e,t)=>e-t),t=Math.floor(e.length/2);a=e.length%2==0?(e[t-1]+e[t])/2:e[t]}return{totalRuntime:e,totalEventsProcessed:this.eventsProcessed,averageEventsPerSecond:t,peakMemoryUsage:i,averageMemoryUsage:r,slowestEventTime:o,fastestEventTime:n,medianEventTime:a}}reset(){this.eventsProcessed=0,this.eventExecutionTimes=[],this.performanceHistory=[],this.simulationStartTime=Date.now(),this.eventQueueSize=0}}e.BaseResource=l,e.ConditionValue=t,e.EmptySchedule=n,e.Environment=class{constructor(e=0){this._now=e,this._queue=new c((e,t)=>e.time!==t.time?e.time-t.time:e.priority!==t.priority?e.priority-t.priority:e.eid-t.eid),this._eid=0,this.activeProcess=null}get now(){return this._now}schedule(e,t="NORMAL",s=0){const i=this._now+s;this._queue.push({time:i,priority:"URGENT"===t?0:1,eid:this._eid++,event:e}),e._scheduled=!0}peek(){if(0===this._queue.size())return 1/0;const e=this._queue.peek();return e?e.time:1/0}step(){if(0===this._queue.size())throw new n;const e=this._queue.pop();if(!e)return;const{time:t,event:s}=e;if(this._now=t,s&&Array.isArray(s.callbacks)){try{for(const e of s.callbacks)"function"==typeof e&&e(s)}catch(e){throw e}if(!s._ok&&!s._defused)throw s._value}}run(e=null){if(null!==e){if("number"!=typeof e&&!(e instanceof s))throw new Error('Invalid "until" argument');"number"!=typeof e&&e.callbacks.push(o.callback)}try{for(;this._queue.size()>0;)this.step()}catch(e){throw e}}process(e){return new a(this,e)}},e.Event=s,e.GetResource=u,e.Heap=c,e.Initialize=i,e.Interrupt=r,e.Logger=m,e.Monitor=class{constructor(e){this.isActive=!1,this.eventIdCounter=0,this.processIdCounter=0,this.resourceIdCounter=0,this.eventIds=new WeakMap,this.processIds=new WeakMap,this.resourceIds=new WeakMap,this.activeProcesses=new Map,this.resourceStates=new Map,this.config=this.mergeConfig(e),this.logger=new m(this.config),this.performanceMonitor=new g(this.logger,this.config.performanceSampleInterval)}mergeConfig(e){return{logLevel:"INFO",enableEventMonitoring:!0,enableProcessMonitoring:!0,enableResourceMonitoring:!0,enablePerformanceMonitoring:!0,performanceSampleInterval:1e3,maxLogEntries:1e4,outputFormat:"TEXT",...e}}start(){this.isActive||(this.isActive=!0,this.config.enablePerformanceMonitoring&&this.performanceMonitor.start(),this.logger.log({timestamp:Date.now(),simulationTime:0,level:"INFO",type:"SIMULATION_STARTED",message:"Monitoring system started",component:"Monitor",metadata:{config:this.config}}))}stop(){this.isActive&&(this.isActive=!1,this.performanceMonitor.stop(),this.logger.log({timestamp:Date.now(),simulationTime:0,level:"INFO",type:"SIMULATION_STOPPED",message:"Monitoring system stopped",component:"Monitor"}))}samplePerformance(){this.config.enablePerformanceMonitoring&&this.performanceMonitor.sampleMetrics()}instrumentEnvironment(e){if(!this.config.enableEventMonitoring)return;const t=e.schedule.bind(e),s=e.step.bind(e);e.schedule=(s,i="NORMAL",r=0)=>{const o=this.getOrCreateEventId(s),n={timestamp:Date.now(),simulationTime:e.now,level:"DEBUG",type:"EVENT_SCHEDULED",message:`Event ${o} scheduled with delay ${r}`,component:"Environment",eventId:o,eventType:s.constructor.name,priority:"URGENT"===i?0:1,delay:r};return this.logger.log(n),t(s,i,r)},e.step=()=>{const t=Date.now();try{s();const i=Date.now()-t;this.config.enablePerformanceMonitoring&&this.performanceMonitor.recordEventExecution(i),this.logger.log({timestamp:Date.now(),simulationTime:e.now,level:"DEBUG",type:"SIMULATION_STEPPED",message:`Simulation step completed in ${i}ms`,component:"Environment",metadata:{executionTime:i,simulationTime:e.now}})}catch(s){const i=Date.now()-t;throw this.logger.log({timestamp:Date.now(),simulationTime:e.now,level:"ERROR",type:"SIMULATION_ERROR",message:`Simulation step failed: ${s}`,component:"Environment",metadata:{error:s instanceof Error?s.message:String(s),executionTime:i}}),s}}}logEventSuccess(e,t){if(!this.config.enableEventMonitoring)return;const s=this.getOrCreateEventId(e),i={timestamp:Date.now(),simulationTime:t.now,level:"DEBUG",type:"EVENT_SUCCEEDED",message:`Event ${s} succeeded`,component:"Event",eventId:s,eventType:e.constructor.name};this.logger.log(i)}logEventFailure(e,t,s){if(!this.config.enableEventMonitoring)return;const i=this.getOrCreateEventId(e),r={timestamp:Date.now(),simulationTime:t.now,level:"WARN",type:"EVENT_FAILED",message:`Event ${i} failed: ${s}`,component:"Event",eventId:i,eventType:e.constructor.name,error:s instanceof Error?s.message:String(s)};this.logger.log(r)}logProcessStart(e,t){if(!this.config.enableProcessMonitoring)return;const s=this.getOrCreateProcessId(e);this.activeProcesses.set(s,{id:s,name:e.name,state:"RUNNING",startTime:t.now,lastActivity:t.now,yieldCount:0});const i={timestamp:Date.now(),simulationTime:t.now,level:"INFO",type:"PROCESS_STARTED",message:`Process ${s} (${e.name}) started`,component:"Process",processId:s,processName:e.name,state:"RUNNING"};this.logger.log(i)}logProcessYield(e,t,s){if(!this.config.enableProcessMonitoring)return;const i=this.getOrCreateProcessId(e),r=this.getOrCreateEventId(s),o=this.activeProcesses.get(i);o&&(o.state="WAITING",o.lastActivity=t.now,o.yieldCount++);const n={timestamp:Date.now(),simulationTime:t.now,level:"DEBUG",type:"PROCESS_YIELDED",message:`Process ${i} yielded to event ${r}`,component:"Process",processId:i,processName:e.name,state:"WAITING",yieldedEvent:r};this.logger.log(n)}logProcessComplete(e,t){if(!this.config.enableProcessMonitoring)return;const s=this.getOrCreateProcessId(e),i=this.activeProcesses.get(s);i&&(i.state="COMPLETED",i.lastActivity=t.now);const r={timestamp:Date.now(),simulationTime:t.now,level:"INFO",type:"PROCESS_COMPLETED",message:`Process ${s} (${e.name}) completed`,component:"Process",processId:s,processName:e.name,state:"COMPLETED"};this.logger.log(r)}logProcessInterrupt(e,t,s){if(!this.config.enableProcessMonitoring)return;const i=this.getOrCreateProcessId(e),r=this.activeProcesses.get(i);r&&(r.state="INTERRUPTED",r.lastActivity=t.now);const o={timestamp:Date.now(),simulationTime:t.now,level:"WARN",type:"PROCESS_INTERRUPTED",message:`Process ${i} (${e.name}) interrupted`,component:"Process",processId:i,processName:e.name,state:"INTERRUPTED",interruptCause:s};this.logger.log(o)}logResourceRequest(e,t,s,i){if(!this.config.enableResourceMonitoring)return;const r=this.getOrCreateResourceId(e),o=i?this.getOrCreateProcessId(i):void 0;this.getOrCreateResourceState(r,e).requestsTotal++;const n={timestamp:Date.now(),simulationTime:s.now,level:"DEBUG",type:"RESOURCE_REQUESTED",message:`Resource ${r} requested (amount: ${t})`,component:"Resource",resourceId:r,resourceType:e.constructor.name,amount:t,currentUsage:e.users.length,capacity:e.capacity,processId:o};this.logger.log(n)}logResourceAcquire(e,t,s,i){if(!this.config.enableResourceMonitoring)return;const r=this.getOrCreateResourceId(e),o=i?this.getOrCreateProcessId(i):void 0,n=this.getOrCreateResourceState(r,e);n.currentUsage=e.users.length,n.utilizationPercent=e.capacity>0?e.users.length/e.capacity*100:0;const a={timestamp:Date.now(),simulationTime:s.now,level:"DEBUG",type:"RESOURCE_ACQUIRED",message:`Resource ${r} acquired (amount: ${t})`,component:"Resource",resourceId:r,resourceType:e.constructor.name,amount:t,currentUsage:e.users.length,capacity:e.capacity,processId:o};this.logger.log(a)}logResourceRelease(e,t,s,i){if(!this.config.enableResourceMonitoring)return;const r=this.getOrCreateResourceId(e),o=i?this.getOrCreateProcessId(i):void 0,n=this.getOrCreateResourceState(r,e);n.currentUsage=e.users.length,n.utilizationPercent=e.capacity>0?e.users.length/e.capacity*100:0,n.releasesTotal++;const a={timestamp:Date.now(),simulationTime:s.now,level:"DEBUG",type:"RESOURCE_RELEASED",message:`Resource ${r} released (amount: ${t})`,component:"Resource",resourceId:r,resourceType:e.constructor.name,amount:t,currentUsage:e.users.length,capacity:e.capacity,processId:o};this.logger.log(a)}getOrCreateEventId(e){return this.eventIds.has(e)||this.eventIds.set(e,"E"+ ++this.eventIdCounter),this.eventIds.get(e)}getOrCreateProcessId(e){return this.processIds.has(e)||this.processIds.set(e,"P"+ ++this.processIdCounter),this.processIds.get(e)}getOrCreateResourceId(e){return this.resourceIds.has(e)||this.resourceIds.set(e,"R"+ ++this.resourceIdCounter),this.resourceIds.get(e)}getOrCreateResourceState(e,t){return this.resourceStates.has(e)||this.resourceStates.set(e,{id:e,type:t.constructor.name,capacity:t.capacity,currentUsage:t.users.length,queueLength:0,utilizationPercent:t.capacity>0?t.users.length/t.capacity*100:0,requestsTotal:0,releasesTotal:0}),this.resourceStates.get(e)}addHook(e){this.logger.addHook(e)}removeHook(e){this.logger.removeHook(e)}getMetrics(e){const t={};return this.resourceStates.forEach((e,s)=>{t[s]=e.utilizationPercent/100}),{simulationTime:e.now,realTime:Date.now(),eventsProcessed:this.performanceMonitor.getCurrentMetrics().eventsProcessed,activeProcesses:Array.from(this.activeProcesses.values()).filter(e=>"RUNNING"===e.state||"WAITING"===e.state).length,queuedEvents:0,resourceUtilization:t,performanceMetrics:this.performanceMonitor.getCurrentMetrics()}}getProcessStates(){return Array.from(this.activeProcesses.values())}getResourceStates(){return Array.from(this.resourceStates.values())}exportLogs(){return this.logger.exportLogs()}getLogStatistics(){return this.logger.getStatistics()}getPerformanceSummary(){return this.performanceMonitor.getPerformanceSummary()}reset(){this.logger.clear(),this.performanceMonitor.reset(),this.eventIdCounter=0,this.processIdCounter=0,this.resourceIdCounter=0,this.activeProcesses.clear(),this.resourceStates.clear()}},e.PerformanceMonitor=g,e.Process=a,e.PutResource=h,e.Resource=class extends l{constructor(e,t=1){if(t<=0)throw new Error('"capacity" must be > 0.');super(e,t),this.users=[]}request(e=1){return new u(this,e)}release(e=1){return new h(this,e)}_doGet(e){if(this.capacity-this.users.length>=e.amount){for(let t=0;t<e.amount;t++)this.users.push(1);return e.succeed(),!0}return!1}_doPut(e){if(this.users.length>=e.amount){for(let t=0;t<e.amount;t++)this.users.pop();return e.succeed(),!0}return!1}},e.StopSimulation=o,e.Timeout=class extends s{constructor(e,t=0,s=null){if(super(e),t<0)throw new Error(`Negative delay value: ${t}`);this._delay=t,this._ok=!0,this._value=s,e.schedule(this,"NORMAL",t)}_desc(){const e=null===this._value?"":`, Value=${this.value}`;return`${this.constructor.name}(${this._delay}${e})`}},Object.defineProperty(e,"__esModule",{value:!0})});